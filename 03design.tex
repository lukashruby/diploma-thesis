% !TeX root = thesis.tex

\label[design]
\chap Design

This chapter is dedicated to the design process. First section is about the requirements of the application followed by a proposal of the architecture. In the second section, the user interface design process is described. Last section contains information about a logging server and other tools.

\sec Requirements

This section describes the essential and most critical features of the designed mobile application. They result from the previous chapter~\ref[analysis] and set a baseline that will be reached in the final mobile application.

\begitems
	* Simplicity of usage - the user flow of the mobile application must be obvious for the user. There is no time in a car for exploring hidden and unclear functionality,
	* Low cognitive load - using the mobile application is a secondary task. Therefore, the cognitive load demand (described in section~\ref[1.distfact]) must be as low as possible,
	* Extensibility of functions - the mobile application is designed as a general \glref{UI} concept with possibility to extend its functionality (e.g., Internet of Things, new in-car information, \glref{V2V} and \glref{V2X} communication, etc.),
	* Logging feature - as a car is great source of driving data, logging possibilities of the data are highly beneficial.
\enditems

\sec Android Design Guidelines

In section \ref[android5] was mentioned that with the release of Android 5 Lollipop, Google provided guidelines for application developers to design user interface in proper way. These guidelines are called Google Design Guidelines~\urlnote{https://www.google.com/design/spec/material-design/introduction.html} and they defines various design rules and parameter constrains. The most important assumption is that the display of the device should be taken as a real-world 3D environment. The whole concept is called Material Design~\urlnote{https://www.google.com/design/spec/what-is-material/environment.html}.


\sec Infotainment user interface architecture proposal

Based on the previous research (led by dr. Sedivy, supervisor of this thesis) the simple user interface structure was proposed. The concept of on-board computers, where the amount of information displayed at a time is limited, was adopted. The general overview of this concept is at figure~\ref[skoda_ui]. 

\midinsert \clabel[skoda_ui]{Limited information shown at display}
\picw=10cm \cinspic resources/images/skodaUI.pdf 
\caption/f Limited information shown at display (credits: dr. Sedivy)
\endinsert

\secc Portrait vs. Landscape mode

\rfc{tohle je nejakej copy paste -> prepsat}
The smartphone changes the user interface based on how the user holds it. The screen in the car can also be in the landscape or portrait mode. The landscape positioning is used by most of the cars on the market. The HP is showing the icons of the key applications and the user is choosing with the pointing device. The icons are fixed or move towards the central screen position. The horizontal pointing is used to move to both sides. The landscape position is on the other side not good for displaying list of names. It is easy to prove this statement. When we search a person in a contact application we can see many more lines in the portrait mode. 

The HP can be designed for both directions the same way, simply moving the focus left to right or up and down. For the radio application, where probably the number one action is changing the station, probably the better format is portrait, since larger number of stations can be displayed. The media application is not that clear: the forward, fast forward or backward, and stop buttons are traditionally arranged horizontally. On the other hand the selection of an artist, song, album, genre etc. will be better in the portrait mode. The navigation map uses in most cases the landscape screen, but again to select the destination is a selection from a list where the portrait positioning might give an advantage. As we have mentioned above, for the phone is probably better the portrait mode. The last key application is the setting of the car parameters. In this case we deal with large number of parameters, where a portrait mode may have an advantage.

It is not easy to lean on either side in selecting the screen positioning. However strictly stickin to one direction of moving between elements on the screen, it is going between icons, and selecting from a list of text may have an advantage. If we would move only horizontally or vertically we will save on the pointing devices, the UI may be more intuitive and easier to learn. Imagine a portrait arrangement, one can move around icons and change lines in lists of names only up and down. This can be easily controlled by two buttons up and down. 

The portrait mode may be also easier to move in between the speedometer and tachometer. Even if the portrait mode is rare it may have some advantages in the amount of information on the screen. However the final selection of the screen positioning is a usability study problem. 

\secc Use cases

This section is dedicated to observation of use cases in which the application will be used. The primary goal of the application is to be used while driving. However, some initial configuration must be done as well. As it would be very hard, time demanding, and even dangerous to set the configurations while driving, better approach is to introduce the second goal. There are two most important use cases for which will be this application designed.

\seccc Using while driving

This use case is supposed to radically predominate. A smartphone is places in a holder, firmly attached to a car's dashboard. Vehicle is moving and user is interacting with the smartphone using one hand and simple gestures while he is still managing the primary task -- driving. 

\seccc Setting up

Second use case aims to the setup part. This use case is applied when the vehicle is not moving and the user does not have to pay attention to external environment. In this use case, initial setup (Bluetooth connection to a OBD II Dongle similar to the described one in section \ref[2.dongle]) is done. 


\sec Graphical User Interface

User interface is one of the most important part of this thesis. User interface is one of the main tools of communication between an application and the user. User is the key factor in designing a user interface - if a user interface design is bad, nobody will use the application.

There are four basic principles of user interface design known since 1971~\cite[Hansen:1972:UEP:1479064.1479159]:

\begitems
* Know the user,
* minimize memorization,
* optimize operations,
* engineer for erros.
\enditems

For the design of a user interface, there have been adopted well-known software engineering processes. For the purpose of this thesis, the simplified iterative model was used. The design of user interface went from the simples sketches to slightly more complex low fidelity prototype to high fidelity prototype which led to the final application. Every phase was evaluated and possibly improved. Throughout the whole process, the notes, and advices from \cite[poi_design] were used. 

\secc Low fidelity prototype

\midinsert
\line{\hsize=.5\hsize \vtop{%
      \clabel[balsamiq_v1]{Low Fidelity mock up version 1}
	\picw=5cm \cinspic resources/images/mockups/v1.png
      \caption/f Low Fidelity mock up version~1
   \par}\vtop{%
      \clabel[balsamiq_v2]{Low Fidelity mock up version 2}
      \picw=5cm \cinspic resources/images/mockups/v2.png
      \caption/f Low Fidelity mock up version~2
   \par}}
\endinsert


Low fidelity prototypes are generally prototypes of limited functionality and interaction. They are constructed to depict concepts, design alternatives, and screen layouts. They are constructed quickly and provide limited or no functionality. These prototypes are created to demonstrate the general look, they are not intended to show in detail how the application operates. They should communicate, educate, and inform, not train, test, or serve as a basis from which to code~\cite[Rudd:1996:LVH:223500.223514].

For the purpose of creating low fidelity prototype of the application, the tool Balsamiq Mock-ups\urlnote{https://balsamiq.com/} was used. It is a rapid wireframing tool that reproduces the experience of sketching on a whiteboard, but using a computer.

The two step approach was applied. In the first step the ideas from previous chapters were used and the first version of lo-fi prototype was sketched. The result is in figure~\ref[balsamiq_v1]. After discussion and basic testing the mock-up was improved and the second version was designed (figure~\ref[balsamiq_v2]).

\secc High fidelity prototype

Unlike low fidelity prototypes, high fidelity prototypes are fully functional and interactive. They address the issues of navigation and flow and of matching the design and user models of a system. High fidelity prototypes are used for exploration and tests. Users can operate them the same way as the final product and they can make informed recommendations about how to improve the user interface~\cite[Rudd:1996:LVH:223500.223514].

High fidelity prototype of the application developed in this thesis was made in the target application's platform \glref{IDE} and continuously improved.


\label[3.server]
\sec Logging server architecture

Server is an additional part to the mobile application. It has only one purpose -- to store log files generated by the mobile application. However, the solution is required to be robust and scalable. The server solution is proposed to be a simple Java HTTP Servlet for managing the communication with mobile clients and Mongo DB database to store the clients' log files.

\secc Java Servlet API

A Java servlet is a Java class that extends the capabillities of an application server. Servlets can respond to different types of requests. The most common use of servlets is with the HTTP protocol\urlnote{https://www.jcp.org/en/jsr/detail?id=315}. Typical HTTP servlet lifecycle is in figure~\ref[servlet]\urlnote{https://www.cse.iitb.ac.in/infolab/Data/Courses/DBIS/Software/servlets/servlet_life.gif}.

\midinsert \clabel[servlet]{Servlet life -- flow diagram}
\picw=\hsize \cinspic resources/images/servlet_life.png
\caption/f Servlet life -- flow diagram\
\endinsert

\secc Mongo DB

MongoDB is a cross-platform document-oriented database. It is classified as a NoSQL database. This properties makes it a perfect candidate for storing data-intensive log files generated by cars.


%\sec Other tools
%
%\rfc{todo}
%
%\secc OBD II Emulator
%
%\rfc{todo}
